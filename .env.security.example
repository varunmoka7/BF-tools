# =============================================================================
# WASTE INTELLIGENCE PLATFORM - SECURITY CONFIGURATION
# =============================================================================

# Environment
NODE_ENV=production
PORT=3000

# =============================================================================
# AUTHENTICATION & AUTHORIZATION
# =============================================================================

# JWT Configuration
JWT_SECRET=your-256-bit-secret-key-change-in-production
JWT_EXPIRY=24h
JWT_REFRESH_EXPIRY=7d
JWT_ISSUER=waste-intelligence-platform
JWT_AUDIENCE=waste-intelligence-api

# Supabase Configuration (CRITICAL - Keep Secure)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
DATABASE_URL=postgresql://postgres:password@db.your-project.supabase.co:5432/postgres

# =============================================================================
# SECURITY HEADERS & CORS
# =============================================================================

# CORS Configuration
ALLOWED_ORIGINS=https://yourdomain.com,https://app.yourdomain.com
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# Security Headers
CSP_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: https:; connect-src 'self' https://api.supabase.co; worker-src 'self' blob:
FRAME_OPTIONS=DENY
CONTENT_TYPE_OPTIONS=nosniff
REFERRER_POLICY=strict-origin-when-cross-origin

# =============================================================================
# RATE LIMITING & DDoS PROTECTION
# =============================================================================

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false
RATE_LIMIT_HEADERS=true

# Authentication Rate Limiting
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX_REQUESTS=5
AUTH_RATE_LIMIT_BLOCK_DURATION=3600000

# API Rate Limiting
API_RATE_LIMIT_WINDOW_MS=900000
API_RATE_LIMIT_MAX_REQUESTS=1000
API_RATE_LIMIT_PREMIUM_MAX_REQUESTS=5000

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================

# HTTPS Settings
FORCE_HTTPS=true
HTTPS_PORT=443
SSL_CERT_PATH=/etc/ssl/certs/cert.pem
SSL_KEY_PATH=/etc/ssl/private/key.pem
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# =============================================================================
# SESSION SECURITY
# =============================================================================

# Session Configuration
SESSION_SECRET=your-session-secret-256-bit-key
SESSION_MAX_AGE=86400000
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict
SESSION_ROLLING=true

# Account Lockout
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION=1800000
LOCKOUT_THRESHOLD=3
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_COMPLEXITY=true

# =============================================================================
# ENCRYPTION & HASHING
# =============================================================================

# Encryption Keys
ENCRYPTION_KEY=your-32-byte-encryption-key-base64
ENCRYPTION_ALGORITHM=aes-256-gcm
HASH_ROUNDS=12
PEPPER_SECRET=your-pepper-secret

# =============================================================================
# MONITORING & LOGGING
# =============================================================================

# Security Monitoring
ENABLE_SECURITY_MONITORING=true
LOG_SECURITY_EVENTS=true
LOG_LEVEL=info
LOG_FORMAT=json
LOG_RETENTION_DAYS=90

# Audit Logging
ENABLE_AUDIT_LOGGING=true
AUDIT_LOG_LEVEL=info
AUDIT_RETENTION_DAYS=365

# Alert Configuration
ENABLE_SECURITY_ALERTS=true
ALERT_EMAIL=security@yourdomain.com
ALERT_WEBHOOK_URL=https://hooks.slack.com/your-webhook
ALERT_THRESHOLD_FAILED_LOGINS=10
ALERT_THRESHOLD_UNUSUAL_ACTIVITY=50

# =============================================================================
# EXTERNAL SECURITY SERVICES
# =============================================================================

# reCAPTCHA
RECAPTCHA_SITE_KEY=your-recaptcha-site-key
RECAPTCHA_SECRET_KEY=your-recaptcha-secret-key
RECAPTCHA_THRESHOLD=0.5

# Security Scanning
SNYK_TOKEN=your-snyk-token
SONARQUBE_TOKEN=your-sonarqube-token
CHECKMARX_API_KEY=your-checkmarx-api-key

# =============================================================================
# COMPLIANCE & PRIVACY
# =============================================================================

# GDPR/Privacy
GDPR_COMPLIANCE=true
DATA_RETENTION_DAYS=2555
ENABLE_RIGHT_TO_DELETE=true
PRIVACY_CONTACT=privacy@yourdomain.com

# PCI DSS (if applicable)
PCI_COMPLIANCE=false
MASK_SENSITIVE_DATA=true

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================

# Database Backup
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_ENCRYPTION=true
BACKUP_S3_BUCKET=your-backup-bucket
BACKUP_S3_REGION=us-east-1

# =============================================================================
# PERFORMANCE & SCALING
# =============================================================================

# Connection Limits
MAX_CONNECTIONS=100
CONNECTION_TIMEOUT=30000
QUERY_TIMEOUT=30000
MAX_PAYLOAD_SIZE=10mb

# Caching
ENABLE_REDIS_CACHE=true
REDIS_URL=redis://localhost:6379
CACHE_TTL=3600

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Security Features
ENABLE_TWO_FACTOR_AUTH=true
ENABLE_BIOMETRIC_AUTH=false
ENABLE_DEVICE_FINGERPRINTING=true
ENABLE_ANOMALY_DETECTION=true
ENABLE_IP_WHITELISTING=false

# API Security
ENABLE_API_VERSIONING=true
ENABLE_API_DEPRECATION_WARNINGS=true
ENABLE_WEBHOOK_SIGNATURE_VERIFICATION=true

# =============================================================================
# DEVELOPMENT/TESTING (Disable in Production)
# =============================================================================

# Debug & Testing (NEVER enable in production)
DEBUG_MODE=false
ENABLE_TEST_ROUTES=false
DISABLE_AUTH_FOR_TESTING=false
MOCK_EXTERNAL_SERVICES=false